import{_ as a,c as t,o as i,ae as e}from"./chunks/framework.Ck3L_38O.js";const k=JSON.parse('{"title":"AstrBot Gemini Video Plugin 🎬","description":"","frontmatter":{},"headers":[],"relativePath":"视频分析.md","filePath":"视频分析.md"}'),n={name:"视频分析.md"};function l(p,s,h,o,d,r){return i(),t("div",null,[...s[0]||(s[0]=[e(`<h1 id="astrbot-gemini-video-plugin-🎬" tabindex="-1">AstrBot Gemini Video Plugin 🎬 <a class="header-anchor" href="#astrbot-gemini-video-plugin-🎬" aria-label="Permalink to &quot;AstrBot Gemini Video Plugin 🎬&quot;">​</a></h1><p><a href="https://github.com/Soulter/AstrBot" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/AstrBot-v3.0+-blue.svg" alt="AstrBot"></a><a href="#"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License"></a></p><blockquote><p>💬 <strong>加入QQ群获取支持</strong>：<a href="https://qun.qq.com/universal-share/share?ac=1&amp;authKey=fqH3xeXAFOlK6983ACfvuMn1uK9cnK8KEwU9p7mprX3DXHncn3uVx%2BcnGmphv%2BZK&amp;busi_data=eyJncm91cENvZGUiOiIzMDg3NDk4MTAiLCJ0b2tlbiI6Ilp4dnk1anEySG9Wdzg1NEI0ZmZ2NkVYcXIwb3QvQ3VNKzNwMGNLYlQ4aGlvTzdJdUJDY011V3hXUjI0cUlRMTUiLCJ1aW4iOiIyMTQ4MTkzNDU4In0=&amp;data=6bw6cjWn50SQWIAWQ9nhxMn1xCHo62sPn4oJP3qWfes7lRZXBAZq1UPnfa31fKPMhMZcQxuIqDA4IildMyb6u_TQHVCntNf4tvSZeFN6D9U&amp;svctype=5&amp;tempid=h5_group_info" target="_blank" rel="noreferrer">点击加入 308749810</a> 🚀</p></blockquote><p>一个为 AstrBot 设计的<strong>高性能、高可靠性</strong> Gemini 视频分析插件。支持多种上传模式、自动压缩、智能网络优化，完美兼容 Agent 工具调用与人格注入。</p><blockquote><p>🎯 <strong>优化重点</strong>：经过深度优化的下载逻辑、上传可靠性、视频压缩，以及针对 QQ/腾讯 CDN 的智能直连优化。</p></blockquote><h2 id="✨-核心特性" tabindex="-1">✨ 核心特性 <a class="header-anchor" href="#✨-核心特性" aria-label="Permalink to &quot;✨ 核心特性&quot;">​</a></h2><h3 id="🚀-智能上传策略" tabindex="-1">🚀 智能上传策略 <a class="header-anchor" href="#🚀-智能上传策略" aria-label="Permalink to &quot;🚀 智能上传策略&quot;">​</a></h3><ul><li><strong>Base64 编码上传</strong>：适用于中小型视频（≤30MB），兼容性最广，能有效绕过部分中转服务商的文件上传限制</li><li><strong>File API 上传</strong>：适用于大型视频，先上传到 API 服务器获取 CDN URL，再进行分析</li><li><strong>自动压缩</strong>：视频超过阈值（默认25MB）时自动调用 <code>ffmpeg</code> 压缩为 720p/CRF28，大幅提高上传成功率</li></ul><h3 id="🎭-深度人格注入" tabindex="-1">🎭 深度人格注入 <a class="header-anchor" href="#🎭-深度人格注入" aria-label="Permalink to &quot;🎭 深度人格注入&quot;">​</a></h3><ul><li>采用 <strong>Double Injection</strong> 策略，将 Gemini 的客观分析与用户配置的人格设定深度融合</li><li>确保机器人的回复既专业准确，又符合其角色性格（如亚托莉的少女萝卜子语气）</li></ul><h3 id="🔄-强制刷新机制" tabindex="-1">🔄 强制刷新机制 <a class="header-anchor" href="#🔄-强制刷新机制" aria-label="Permalink to &quot;🔄 强制刷新机制&quot;">​</a></h3><ul><li>每次分析都触发<strong>强制重新下载</strong>和<strong>重新分析</strong></li><li>不依赖过时的本地缓存，确保获取视频的最新内容</li><li>适用于实时更新的视频内容场景</li></ul><h3 id="🌐-网络优化与可靠性" tabindex="-1">🌐 网络优化与可靠性 <a class="header-anchor" href="#🌐-网络优化与可靠性" aria-label="Permalink to &quot;🌐 网络优化与可靠性&quot;">​</a></h3><ul><li><strong>智能代理绕过</strong>：自动检测 QQ/腾讯 CDN 域名（<code>.qq.com</code>、<code>.qq.com.cn</code>、<code>.tencent.com</code>），强制直连以获得最佳速度</li><li><strong>多轮重试机制</strong>：下载、上传均支持可配置的重试次数和间隔</li><li><strong>超时监控</strong>：实时监控下载速度和上传进度，防止卡死</li><li><strong>OneBot 协议兼容</strong>：支持 <code>get_file</code> 和 <code>download_file</code> 接口，解析文件 ID 为真实 URL/路径</li></ul><h3 id="🤖-agent-工具集成" tabindex="-1">🤖 Agent 工具集成 <a class="header-anchor" href="#🤖-agent-工具集成" aria-label="Permalink to &quot;🤖 Agent 工具集成&quot;">​</a></h3><ul><li><strong>函数工具调用</strong>：注册为 <code>gemini_analyze_video</code> 工具，LLM 可自动调用</li><li><strong>Reply 消息优先</strong>：当用户回复（Reply）包含视频的消息时，优先分析被引用的视频，而非从聊天历史中错误提取</li><li><strong>即时反馈</strong>：调用工具时立即发送&quot;正在分析...&quot;提示（可自定义 <code>watching_hint</code>）</li></ul><h3 id="🧹-自动维护" tabindex="-1">🧹 自动维护 <a class="header-anchor" href="#🧹-自动维护" aria-label="Permalink to &quot;🧹 自动维护&quot;">​</a></h3><ul><li>后台清理任务定期删除过期视频（默认3天）</li><li>支持自定义清理间隔（默认6小时）</li><li>磁盘空间无忧</li></ul><h3 id="💬-完美配套" tabindex="-1">💬 完美配套 <a class="header-anchor" href="#💬-完美配套" aria-label="Permalink to &quot;💬 完美配套&quot;">​</a></h3><ul><li>兼容 <code>Splitter</code> 插件（分段回复）</li><li>兼容 AstrBot 内置 TTS 系统</li><li>支持流式响应和 SSE 格式</li></ul><hr><h2 id="📦-安装方法" tabindex="-1">📦 安装方法 <a class="header-anchor" href="#📦-安装方法" aria-label="Permalink to &quot;📦 安装方法&quot;">​</a></h2><h3 id="方式一-通过-astrbot-管理面板-推荐" tabindex="-1">方式一：通过 AstrBot 管理面板（推荐） <a class="header-anchor" href="#方式一-通过-astrbot-管理面板-推荐" aria-label="Permalink to &quot;方式一：通过 AstrBot 管理面板（推荐）&quot;">​</a></h3><ol><li>打开 AstrBot Web 管理面板</li><li>导航到&quot;插件&quot; → &quot;安装插件&quot;</li><li>输入仓库地址：<div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://github.com/Liangyu-G/astrbot_plugin_gemini-video</span></span></code></pre></div></li><li>等待安装完成，重启机器人</li></ol><h3 id="方式二-手动安装" tabindex="-1">方式二：手动安装 <a class="header-anchor" href="#方式二-手动安装" aria-label="Permalink to &quot;方式二：手动安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AstrBot/data/plugins</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/Liangyu-G/astrbot_plugin_gemini-video</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重启 AstrBot</span></span></code></pre></div><h3 id="依赖要求" tabindex="-1">依赖要求 <a class="header-anchor" href="#依赖要求" aria-label="Permalink to &quot;依赖要求&quot;">​</a></h3><ul><li><strong>FFmpeg</strong>（可选，但强烈推荐）：用于视频压缩功能 <ul><li>Windows: 下载 FFmpeg，添加到 PATH</li><li>Linux/macOS: <code>apt install ffmpeg</code> 或 <code>brew install ffmpeg</code></li></ul></li></ul><hr><h2 id="⚙️-配置详解" tabindex="-1">⚙️ 配置详解 <a class="header-anchor" href="#⚙️-配置详解" aria-label="Permalink to &quot;⚙️ 配置详解&quot;">​</a></h2><h3 id="基本配置" tabindex="-1">基本配置 <a class="header-anchor" href="#基本配置" aria-label="Permalink to &quot;基本配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>base_url</code></td><td style="text-align:left;">Gemini API 基础 URL</td><td style="text-align:left;"><em>必填</em></td><td style="text-align:left;">支持官方 API 和第三方中转（如柏拉图）</td></tr><tr><td style="text-align:left;"><code>api_key</code></td><td style="text-align:left;">API 密钥</td><td style="text-align:left;"><em>必填</em></td><td style="text-align:left;">确保有充足的配额</td></tr><tr><td style="text-align:left;"><code>model</code></td><td style="text-align:left;">使用的模型</td><td style="text-align:left;"><code>gemini-3-flash-preview</code></td><td style="text-align:left;">推荐 flash 系列，速度快</td></tr><tr><td style="text-align:left;"><code>max_tokens</code></td><td style="text-align:left;">最大生成 Token 数</td><td style="text-align:left;"><code>4000</code></td><td style="text-align:left;">分析结果的长度限制</td></tr></tbody></table><h3 id="上传模式配置" tabindex="-1">上传模式配置 <a class="header-anchor" href="#上传模式配置" aria-label="Permalink to &quot;上传模式配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>upload_mode</code></td><td style="text-align:left;">上传模式</td><td style="text-align:left;"><code>base64</code></td><td style="text-align:left;"><code>base64</code> 或 <code>file_api</code></td></tr><tr><td style="text-align:left;"><code>max_base64_size_mb</code></td><td style="text-align:left;">Base64 模式最大文件大小</td><td style="text-align:left;"><code>30</code></td><td style="text-align:left;">建议 20-30MB</td></tr><tr><td style="text-align:left;"><code>upload_retries</code></td><td style="text-align:left;">上传重试次数</td><td style="text-align:left;"><code>3</code></td><td style="text-align:left;">网络不稳定时可增加</td></tr><tr><td style="text-align:left;"><code>upload_stream_timeout</code></td><td style="text-align:left;">上传流超时（秒）</td><td style="text-align:left;"><code>3600</code></td><td style="text-align:left;">File API 模式推荐 ≥600s</td></tr></tbody></table><h3 id="视频压缩配置" tabindex="-1">视频压缩配置 <a class="header-anchor" href="#视频压缩配置" aria-label="Permalink to &quot;视频压缩配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>enable_compression</code></td><td style="text-align:left;">是否启用自动压缩</td><td style="text-align:left;"><code>true</code></td><td style="text-align:left;">需要安装 FFmpeg</td></tr><tr><td style="text-align:left;"><code>compression_threshold_mb</code></td><td style="text-align:left;">压缩触发阈值（MB）</td><td style="text-align:left;"><code>25</code></td><td style="text-align:left;">超过此大小自动压缩</td></tr></tbody></table><p><strong>压缩策略</strong>：</p><ul><li>分辨率：缩放到 720p（保持宽高比）</li><li>编码：H.264，CRF 28（平衡质量与文件大小）</li><li>通常可减小文件 60-80%</li></ul><h3 id="下载与网络配置" tabindex="-1">下载与网络配置 <a class="header-anchor" href="#下载与网络配置" aria-label="Permalink to &quot;下载与网络配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>download_retries</code></td><td style="text-align:left;">下载重试次数</td><td style="text-align:left;"><code>3</code></td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;"><code>download_retry_delay</code></td><td style="text-align:left;">重试间隔（秒）</td><td style="text-align:left;"><code>5</code></td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;"><code>download_stream_timeout</code></td><td style="text-align:left;">下载流超时（秒）</td><td style="text-align:left;"><code>300</code></td><td style="text-align:left;">大视频可适当增加</td></tr><tr><td style="text-align:left;"><code>proxy</code></td><td style="text-align:left;">HTTP 代理地址</td><td style="text-align:left;"><em>空</em></td><td style="text-align:left;">格式：<code>http://host:port</code></td></tr></tbody></table><p><strong>智能代理绕过</strong>：</p><ul><li>QQ/腾讯 CDN 域名（如 <code>multimedia.nt.qq.com.cn</code>）会自动绕过代理，强制直连</li><li>提高国内视频下载速度</li></ul><h3 id="其他配置" tabindex="-1">其他配置 <a class="header-anchor" href="#其他配置" aria-label="Permalink to &quot;其他配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th></tr></thead><tbody><tr><td style="text-align:left;"><code>default_prompt</code></td><td style="text-align:left;">默认分析提示词</td><td style="text-align:left;"><em>详细分析提示</em></td></tr><tr><td style="text-align:left;"><code>watching_hint</code></td><td style="text-align:left;">分析中的提示文本</td><td style="text-align:left;"><code>亚托莉正在看视频哦~</code></td></tr><tr><td style="text-align:left;"><code>video_retention_days</code></td><td style="text-align:left;">视频保留天数</td><td style="text-align:left;"><code>3</code></td></tr><tr><td style="text-align:left;"><code>cleanup_interval_hours</code></td><td style="text-align:left;">清理检查间隔（小时）</td><td style="text-align:left;"><code>6</code></td></tr><tr><td style="text-align:left;"><code>max_video_size_mb</code></td><td style="text-align:left;">允许的最大视频大小</td><td style="text-align:left;"><code>100</code></td></tr></tbody></table><hr><h2 id="📖-使用指南" tabindex="-1">📖 使用指南 <a class="header-anchor" href="#📖-使用指南" aria-label="Permalink to &quot;📖 使用指南&quot;">​</a></h2><h3 id="方式一-命令触发" tabindex="-1">方式一：命令触发 <a class="header-anchor" href="#方式一-命令触发" aria-label="Permalink to &quot;方式一：命令触发&quot;">​</a></h3><p><strong>直接分析视频</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 发送视频到群/私聊</span></span>
<span class="line"><span>2. 发送命令：/分析视频</span></span></code></pre></div><p><strong>引用视频分析</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 回复（Reply）包含视频的消息</span></span>
<span class="line"><span>2. 发送：/分析视频 请分析这个视频的剪辑技巧</span></span></code></pre></div><p><strong>自定义提示词</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/分析视频 分析这个视频的音乐风格和情绪表达</span></span></code></pre></div><h3 id="方式二-llm-工具调用-推荐" tabindex="-1">方式二：LLM 工具调用（推荐） <a class="header-anchor" href="#方式二-llm-工具调用-推荐" aria-label="Permalink to &quot;方式二：LLM 工具调用（推荐）&quot;">​</a></h3><p>如果您的主 LLM 支持 Function Calling（如 GPT-4、Claude、Gemini），可以直接在对话中说：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>- &quot;帮我看看这个视频讲了什么&quot;</span></span>
<span class="line"><span>- &quot;分析一下刚才那个视频的拍摄手法&quot;</span></span>
<span class="line"><span>- &quot;这个视频里的 AI 在讨论什么话题？&quot;</span></span></code></pre></div><p><strong>工作流程</strong>：</p><ol><li>LLM 识别用户意图，调用 <code>gemini_analyze_video</code> 工具</li><li>插件发送&quot;正在分析...&quot;提示（立即反馈）</li><li>下载视频 → 压缩（如需要）→ 上传 → 调用 Gemini API</li><li>返回分析结果给 LLM</li><li>LLM 基于分析结果，以设定的人格语气回复用户</li></ol><p><strong>Reply 消息优先机制</strong>：</p><ul><li>当您回复（Reply）一个包含视频的消息时，插件<strong>优先分析被引用的视频</strong></li><li>即使 LLM 从聊天历史中提取了其他 URL，也会被忽略</li><li>确保&quot;分析的就是您想要的那个视频&quot;</li></ul><hr><h2 id="🔧-工作原理" tabindex="-1">🔧 工作原理 <a class="header-anchor" href="#🔧-工作原理" aria-label="Permalink to &quot;🔧 工作原理&quot;">​</a></h2><h3 id="视频定位逻辑" tabindex="-1">视频定位逻辑 <a class="header-anchor" href="#视频定位逻辑" aria-label="Permalink to &quot;视频定位逻辑&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 优先检查 Reply 消息中的视频（从缓存或 chain 获取）</span></span>
<span class="line"><span>2. 检查当前消息中的视频</span></span>
<span class="line"><span>3. LLM 提供的 URL（仅作为后备）</span></span></code></pre></div><h3 id="下载流程" tabindex="-1">下载流程 <a class="header-anchor" href="#下载流程" aria-label="Permalink to &quot;下载流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检测 URL 类型：</span></span>
<span class="line"><span>   - file:/// → 直接使用本地路径</span></span>
<span class="line"><span>   - HTTP URL → 进入下载流程</span></span>
<span class="line"><span>   - 文件名/ID → 调用 OneBot get_file 解析</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>2. 智能代理判断：</span></span>
<span class="line"><span>   - QQ/腾讯域名 → 强制直连</span></span>
<span class="line"><span>   - 其他域名 → 使用配置的 proxy</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>3. 下载监控：</span></span>
<span class="line"><span>   - 每10秒检查速度</span></span>
<span class="line"><span>   - 停滞检测（30秒无数据传输则报错）</span></span>
<span class="line"><span>   - 支持多轮重试</span></span></code></pre></div><h3 id="上传与分析流程" tabindex="-1">上传与分析流程 <a class="header-anchor" href="#上传与分析流程" aria-label="Permalink to &quot;上传与分析流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检查文件大小</span></span>
<span class="line"><span>2. 触发压缩（如超过阈值）</span></span>
<span class="line"><span>3. 根据 upload_mode 选择模式：</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>   Base64 模式：</span></span>
<span class="line"><span>   - 检查大小 ≤ max_base64_size_mb</span></span>
<span class="line"><span>   - Base64 编码</span></span>
<span class="line"><span>   - 构造 data URI</span></span>
<span class="line"><span>   - 调用 OpenAI 兼容 API</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>   File API 模式：</span></span>
<span class="line"><span>   - 上传到 /v1/files 端点</span></span>
<span class="line"><span>   - 获取 file_uri</span></span>
<span class="line"><span>   - 轮询文件状态（等待 ACTIVE）</span></span>
<span class="line"><span>   - 调用 Gemini Native API</span></span></code></pre></div><h3 id="人格注入策略-double-injection" tabindex="-1">人格注入策略（Double Injection） <a class="header-anchor" href="#人格注入策略-double-injection" aria-label="Permalink to &quot;人格注入策略（Double Injection）&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">final_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[System Instruction: You are </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">system_prompt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Context: The user sent a video. Here is a description of the video content:]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gemini_analysis_result</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[User Request: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_prompt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Task: Reply to the User Request based on the video description. </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Important: You must ACT AS your persona. Do NOT act as an AI assistant. Stay in character.]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span></code></pre></div><hr><h2 id="❓-常见问题与故障排查" tabindex="-1">❓ 常见问题与故障排查 <a class="header-anchor" href="#❓-常见问题与故障排查" aria-label="Permalink to &quot;❓ 常见问题与故障排查&quot;">​</a></h2><h3 id="q1-提示-视频分析失败-未能获取分析结果" tabindex="-1">Q1: 提示&quot;视频分析失败，未能获取分析结果&quot; <a class="header-anchor" href="#q1-提示-视频分析失败-未能获取分析结果" aria-label="Permalink to &quot;Q1: 提示&quot;视频分析失败，未能获取分析结果&quot;&quot;">​</a></h3><p><strong>可能原因</strong>：</p><ol><li>API Key 无效或配额不足</li><li>Base URL 配置错误</li><li>网络连接问题（无法访问 API）</li></ol><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检查 api_key 是否正确</span></span>
<span class="line"><span>2. 尝试访问 base_url（如 curl https://api.bltcy.ai）</span></span>
<span class="line"><span>3. 如使用代理，检查 proxy 配置</span></span>
<span class="line"><span>4. 查看日志中的详细错误信息</span></span></code></pre></div><h3 id="q2-下载速度极慢-50-kb-s" tabindex="-1">Q2: 下载速度极慢（&lt;50 KB/s） <a class="header-anchor" href="#q2-下载速度极慢-50-kb-s" aria-label="Permalink to &quot;Q2: 下载速度极慢（&lt;50 KB/s）&quot;">​</a></h3><p><strong>可能原因</strong>：</p><ol><li>QQ CDN 域名未被正确识别为国内域名</li><li>网络环境限制（运营商 QoS）</li><li>服务器端限流</li></ol><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 查看日志，确认是否有&quot;检测到国内域名，强制直连&quot;</span></span>
<span class="line"><span>2. 如果没有，检查 main.py:559 的域名匹配逻辑</span></span>
<span class="line"><span>3. 尝试清空 proxy 配置（国内视频不需要代理）</span></span>
<span class="line"><span>4. 考虑使用 OneBot 的 download_file API（如支持）</span></span></code></pre></div><h3 id="q3-上传失败-提示-77-处停滞" tabindex="-1">Q3: 上传失败，提示 77% 处停滞 <a class="header-anchor" href="#q3-上传失败-提示-77-处停滞" aria-label="Permalink to &quot;Q3: 上传失败，提示 77% 处停滞&quot;">​</a></h3><p><strong>可能原因</strong>：</p><ul><li>服务器端超时（通常为 120 秒）</li><li>本地代理的超时限制</li></ul><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 启用视频压缩：enable_compression = true</span></span>
<span class="line"><span>2. 减小 compression_threshold_mb（如 20）</span></span>
<span class="line"><span>3. 切换到 file_api 模式（如中转支持）</span></span>
<span class="line"><span>4. 增加 upload_stream_timeout</span></span>
<span class="line"><span>5. 如使用本地代理，调整代理的超时设置</span></span></code></pre></div><h3 id="q4-ffmpeg-未找到-压缩失败" tabindex="-1">Q4: FFmpeg 未找到，压缩失败 <a class="header-anchor" href="#q4-ffmpeg-未找到-压缩失败" aria-label="Permalink to &quot;Q4: FFmpeg 未找到，压缩失败&quot;">​</a></h3><p><strong>现象</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Gemini Video] FFmpeg not found, skipping compression</span></span></code></pre></div><p><strong>解决方案</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">下载</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FFmpeg，解压后将</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 目录添加到系统</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PATH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 验证安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ffmpeg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><h3 id="q5-base64-模式提示文件过大" tabindex="-1">Q5: Base64 模式提示文件过大 <a class="header-anchor" href="#q5-base64-模式提示文件过大" aria-label="Permalink to &quot;Q5: Base64 模式提示文件过大&quot;">​</a></h3><p><strong>错误示例</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>❌ 视频文件过大 (35.2MB)，Base64 模式最大支持 30MB</span></span></code></pre></div><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>方案一：启用压缩</span></span>
<span class="line"><span>- enable_compression: true</span></span>
<span class="line"><span>- compression_threshold_mb: 25</span></span>
<span class="line"><span></span></span>
<span class="line"><span>方案二：切换上传模式</span></span>
<span class="line"><span>- upload_mode: &quot;file_api&quot;</span></span>
<span class="line"><span>（需要 API 支持 /v1/files 端点）</span></span>
<span class="line"><span></span></span>
<span class="line"><span>方案三：调整限制（不推荐）</span></span>
<span class="line"><span>- max_base64_size_mb: 50</span></span>
<span class="line"><span>（可能导致请求失败）</span></span></code></pre></div><h3 id="q6-分析的是错误的视频-聊天历史中的旧视频" tabindex="-1">Q6: 分析的是错误的视频（聊天历史中的旧视频） <a class="header-anchor" href="#q6-分析的是错误的视频-聊天历史中的旧视频" aria-label="Permalink to &quot;Q6: 分析的是错误的视频（聊天历史中的旧视频）&quot;">​</a></h3><p><strong>原因</strong>：</p><ul><li>LLM 从聊天历史中提取了旧视频的 URL</li></ul><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>插件已修复此问题（v1.1.0+）：</span></span>
<span class="line"><span>- 现在优先检查 Reply 消息中的视频</span></span>
<span class="line"><span>- LLM 提供的 URL 仅作为后备</span></span>
<span class="line"><span>- 确保更新到最新版本</span></span></code></pre></div><h3 id="q7-onebot-平台视频下载失败" tabindex="-1">Q7: OneBot 平台视频下载失败 <a class="header-anchor" href="#q7-onebot-平台视频下载失败" aria-label="Permalink to &quot;Q7: OneBot 平台视频下载失败&quot;">​</a></h3><p><strong>错误示例</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>UnsupportedProtocol: Request URL is missing an &#39;http://&#39; or &#39;https://&#39; protocol</span></span></code></pre></div><p><strong>原因</strong>：</p><ul><li>OneBot 返回的是文件 ID（如 <code>abc123.mp4</code>），不是 URL</li></ul><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>插件已自动处理（v1.1.0+）：</span></span>
<span class="line"><span>- 自动调用 get_file 接口解析文件 ID</span></span>
<span class="line"><span>- 确保 OneBot 实现（如 LLOneBot）支持 get_file</span></span>
<span class="line"><span>- 查看日志确认是否成功解析</span></span></code></pre></div><hr><h2 id="🔍-配置示例" tabindex="-1">🔍 配置示例 <a class="header-anchor" href="#🔍-配置示例" aria-label="Permalink to &quot;🔍 配置示例&quot;">​</a></h2><h3 id="示例一-国内环境-柏拉图-api-推荐" tabindex="-1">示例一：国内环境 + 柏拉图 API（推荐） <a class="header-anchor" href="#示例一-国内环境-柏拉图-api-推荐" aria-label="Permalink to &quot;示例一：国内环境 + 柏拉图 API（推荐）&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;base_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.bltcy.ai&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;api_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;your_api_key_here&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;model&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gemini-3-flash-preview&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;max_base64_size_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;enable_compression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compression_threshold_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;download_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="示例二-国外环境-官方-api" tabindex="-1">示例二：国外环境 + 官方 API <a class="header-anchor" href="#示例二-国外环境-官方-api" aria-label="Permalink to &quot;示例二：国外环境 + 官方 API&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;base_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://generativelanguage.googleapis.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;api_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AIza...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;model&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gemini-2.5-flash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file_api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;enable_compression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:7890&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_stream_timeout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="示例三-网络不稳定环境" tabindex="-1">示例三：网络不稳定环境 <a class="header-anchor" href="#示例三-网络不稳定环境" aria-label="Permalink to &quot;示例三：网络不稳定环境&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;download_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;download_retry_delay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;enable_compression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compression_threshold_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;max_base64_size_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="🛠️-技术细节" tabindex="-1">🛠️ 技术细节 <a class="header-anchor" href="#🛠️-技术细节" aria-label="Permalink to &quot;🛠️ 技术细节&quot;">​</a></h2><h3 id="依赖库" tabindex="-1">依赖库 <a class="header-anchor" href="#依赖库" aria-label="Permalink to &quot;依赖库&quot;">​</a></h3><ul><li><code>httpx</code>: HTTP 客户端（支持流式下载/上传、代理）</li><li><code>asyncio</code>: 异步 I/O</li><li><code>ffmpeg</code>: 视频压缩（外部依赖）</li><li><code>pathlib</code>: 路径操作</li><li><code>base64</code>: Base64 编码</li></ul><h3 id="性能特性" tabindex="-1">性能特性 <a class="header-anchor" href="#性能特性" aria-label="Permalink to &quot;性能特性&quot;">​</a></h3><ul><li><strong>异步下载</strong>：使用 <code>aiter_bytes()</code> 流式下载，内存友好</li><li><strong>并发控制</strong>：URL 级别的下载锁，防止重复下载</li><li><strong>智能缓存</strong>：消息级别的视频路径缓存</li><li><strong>后台清理</strong>：独立的 <code>asyncio.Task</code> 定期清理过期文件</li></ul><h3 id="安全特性" tabindex="-1">安全特性 <a class="header-anchor" href="#安全特性" aria-label="Permalink to &quot;安全特性&quot;">​</a></h3><ul><li>API Key 日志脱敏（显示为 <code>********</code>）</li><li>临时文件自动清理</li><li>文件大小限制（防止磁盘占用过大）</li></ul><hr><h2 id="📝-更新日志" tabindex="-1">📝 更新日志 <a class="header-anchor" href="#📝-更新日志" aria-label="Permalink to &quot;📝 更新日志&quot;">​</a></h2><h3 id="v1-1-0-2026-01-10" tabindex="-1">v1.1.0 (2026-01-10) <a class="header-anchor" href="#v1-1-0-2026-01-10" aria-label="Permalink to &quot;v1.1.0 (2026-01-10)&quot;">​</a></h3><ul><li>✨ 新增：自动视频压缩（ffmpeg）</li><li>✨ 新增：可配置的上传重试和 Base64 大小限制</li><li>🐛 修复：Reply 消息优先级问题（不再分析错误的视频）</li><li>🐛 修复：QQ CDN 域名检测（支持 <code>.qq.com.cn</code>）</li><li>🐛 修复：OneBot 文件 ID 解析（支持 <code>get_file</code>）</li><li>🐛 修复：Agent 工具调用的即时反馈</li><li>⚡ 优化：智能代理绕过逻辑</li><li>⚡ 优化：下载速度监控和停滞检测</li><li>📝 文档：全面更新 README 和配置说明</li></ul><h3 id="v1-0-0-初始版本" tabindex="-1">v1.0.0 (初始版本) <a class="header-anchor" href="#v1-0-0-初始版本" aria-label="Permalink to &quot;v1.0.0 (初始版本)&quot;">​</a></h3><ul><li>基础功能实现</li></ul><hr><h2 id="🤝-贡献与支持" tabindex="-1">🤝 贡献与支持 <a class="header-anchor" href="#🤝-贡献与支持" aria-label="Permalink to &quot;🤝 贡献与支持&quot;">​</a></h2><h3 id="💬-qq交流群" tabindex="-1">💬 QQ交流群 <a class="header-anchor" href="#💬-qq交流群" aria-label="Permalink to &quot;💬 QQ交流群&quot;">​</a></h3><p><strong>遇到问题？想要交流经验？加入我们的QQ群！</strong></p><ul><li><strong>群号</strong>：308749810</li><li><strong>加群链接</strong>：<a href="https://qun.qq.com/universal-share/share?ac=1&amp;authKey=fqH3xeXAFOlK6983ACfvuMn1uK9cnK8KEwU9p7mprX3DXHncn3uVx%2BcnGmphv%2BZK&amp;busi_data=eyJncm91cENvZGUiOiIzMDg3NDk4MTAiLCJ0b2tlbiI6Ilp4dnk1anEySG9Wdzg1NEI0ZmZ2NkVYcXIwb3QvQ3VNKzNwMGNLYlQ4aGlvTzdJdUJDY011V3hXUjI0cUlRMTUiLCJ1aW4iOiIyMTQ4MTkzNDU4In0=&amp;data=6bw6cjWn50SQWIAWQ9nhxMn1xCHo62sPn4oJP3qWfes7lRZXBAZq1UPnfa31fKPMhMZcQxuIqDA4IildMyb6u_TQHVCntNf4tvSZeFN6D9U&amp;svctype=5&amp;tempid=h5_group_info" target="_blank" rel="noreferrer">点击加入</a> 🚀</li></ul><p>在群里可以：</p><ul><li>💡 快速获取技术支持</li><li>🐛 反馈Bug和问题</li><li>💬 与其他用户交流使用经验</li><li>🎯 提出功能建议</li><li>📢 获取最新版本发布通知</li></ul><h3 id="问题反馈" tabindex="-1">问题反馈 <a class="header-anchor" href="#问题反馈" aria-label="Permalink to &quot;问题反馈&quot;">​</a></h3><p>遇到问题？请提交 Issue： <a href="https://github.com/Liangyu-G/astrbot_plugin_gemini-video/issues" target="_blank" rel="noreferrer">https://github.com/Liangyu-G/astrbot_plugin_gemini-video/issues</a></p><h3 id="功能建议" tabindex="-1">功能建议 <a class="header-anchor" href="#功能建议" aria-label="Permalink to &quot;功能建议&quot;">​</a></h3><p>欢迎提交 Feature Request 或 Pull Request！</p><h3 id="测试环境" tabindex="-1">测试环境 <a class="header-anchor" href="#测试环境" aria-label="Permalink to &quot;测试环境&quot;">​</a></h3><ul><li>✅ LLOneBot + 柏拉图 API</li><li>⚠️ 其他平台未充分测试，欢迎反馈兼容性问题</li></ul><hr><h2 id="📄-许可证" tabindex="-1">📄 许可证 <a class="header-anchor" href="#📄-许可证" aria-label="Permalink to &quot;📄 许可证&quot;">​</a></h2><p>MIT License</p><hr><p><strong>Love and Robots — 毕竟，亚托莉可是高性能的嘛！</strong> 🤖💖</p>`,149)])])}const g=a(n,[["render",l]]);export{k as __pageData,g as default};

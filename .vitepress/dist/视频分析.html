<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AstrBot Gemini Video Plugin 🎬 | ATRI -My Dear Moments-</title>
    <meta name="description" content="A VitePress Site">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.B6tXkhGK.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.Xd-LFGkX.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.D1Bg_sz3.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Ck3L_38O.js">
    <link rel="modulepreload" href="/assets/视频分析.md.CAwGu9K8.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>ATRI -My Dear Moments-</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>主页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ZeroBot.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>功能页</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://qm.qq.com/q/nUxFhoI0VO" aria-label="qq" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-qq"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://qm.qq.com/q/nUxFhoI0VO" aria-label="qq" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-qq"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>功能列表</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%8D%90%E8%B5%A0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>捐赠</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E8%A7%86%E9%A2%91%E5%88%86%E6%9E%90.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>视频分析</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/ZeroBot.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>功能大合集</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%A6%81%E6%BC%AB%E4%B8%8B%E8%BD%BD.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>禁漫下载</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%A6%81%E6%BC%AB%E6%90%9C%E7%B4%A2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>禁漫搜索</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%90%9C%E5%9B%BE%E4%B8%8E%E8%89%B2%E5%9B%BE.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>搜图与色图</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/Steam%E4%BB%B7%E6%A0%BC%E6%9F%A5%E8%AF%A2%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Steam价格查询插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%B9%BF%E6%92%AD%E5%8A%A9%E6%89%8B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>广播助手</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%99%BA%E8%83%BD%E5%90%88%E5%B9%B6%E8%BD%AC%E5%8F%91%E5%88%86%E6%9E%90%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>智能合并转发分析插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%8C%9CCS%E8%81%8C%E4%B8%9A%E9%80%89%E6%89%8B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>猜CS职业选手</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E9%AA%97%E5%AD%90%E9%85%92%E9%A6%86.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>骗子酒馆</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/AI%E8%A1%A8%E6%83%85%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>AI表情包管理器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%88%B3%E4%B8%80%E6%88%B3.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>戳一戳</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/Steam%E6%88%AA%E5%9B%BE.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Steam截图</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%8A%A8%E6%80%81%E6%96%87%E5%AD%97%E5%86%92%E9%99%A9.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>动态文字冒险</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/QQ%E7%BE%A4%E6%97%A5%E5%B8%B8%E5%88%86%E6%9E%90%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>QQ群日常分析插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%BE%B7%E5%B7%9E%E6%89%91%E5%85%8B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>德州扑克</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E8%89%B2%E6%83%85%E6%B2%89%E6%B5%B8%E5%BC%8F%E4%BA%92%E5%8A%A8%E6%8E%A7%E5%88%B6%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>色情沉浸式互动控制插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%89%93%E8%83%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>打胶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E4%BF%84%E7%BD%97%E6%96%AF%E8%BD%AE%E7%9B%98%E8%B5%8C.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>俄罗斯轮盘赌</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%93%8D%E6%8E%A7BOT%E7%9A%84%E4%BE%BF%E6%8D%B7%E5%91%BD%E4%BB%A4.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>操控BOT的便捷命令</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%B9%BB%E5%BD%B1%E5%9D%A6%E5%85%8B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>幻影坦克</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E4%BA%BA%E7%94%9F%E9%87%8D%E5%BC%80%E6%A8%A1%E6%8B%9F%E5%99%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>人生重开模拟器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/RSSHub.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>RSSHub</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/URL%E6%91%98%E8%A6%81%E6%8F%90%E5%8F%96%E5%99%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>URL摘要提取器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%AF%BC%E7%AE%A1%E8%AE%B0%E5%BD%95.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>导管记录</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/One%20Last%20Kiss%20%E9%A3%8E%E6%A0%BC%E7%94%9F%E6%88%90%E5%99%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>One Last Kiss 风格生成器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/AI%E6%99%BA%E8%83%BD%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>AI智能定时任务插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/Token%E4%BD%BF%E7%94%A8%E7%9B%91%E6%8E%A7%E4%B8%8E%E7%AE%A1%E7%90%86.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Token使用监控与管理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/QQ%E8%BF%9D%E8%A7%84%E8%AE%B0%E5%BD%95%E6%9F%A5%E8%AF%A2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>QQ违规记录查询</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E4%BA%94%E5%AD%90%E6%A3%8B%E6%B8%B8%E6%88%8F.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>五子棋游戏</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E8%AF%84%E4%BB%B7QQ%E5%A4%B4%E5%83%8F.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>评价QQ头像</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%BC%80%E7%9B%92%E7%BE%A4%E5%8F%8B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>开盒群友</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/AI%E7%94%BB%E5%9B%BE.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>AI画图</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%BE%A4%E6%88%90%E5%91%98%E6%9F%A5%E8%AF%A2%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>群成员查询插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%85%B3%E9%94%AE%E8%AF%8D%E8%87%AA%E5%8A%A8%E5%9B%9E%E5%A4%8D.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>关键词自动回复</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E8%A7%A3%E6%9E%90%E6%B5%81%E5%AA%92%E4%BD%93%E5%B9%B3%E5%8F%B0%E9%93%BE%E6%8E%A5.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>解析流媒体平台链接</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/Sora%20%E6%A8%A1%E5%9E%8B%E7%94%9F%E6%88%90%E8%A7%86%E9%A2%91.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Sora 模型生成视频</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E8%A3%81%E5%89%AA%E5%92%8C%E5%90%88%E5%B9%B6gif.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>裁剪和合并gif</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%8C%AA%E7%8C%AA%E8%A1%A8%E6%83%85%E5%8C%85.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>猪猪表情包</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>硬件信息查询</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E6%97%A0%E7%95%8F%E5%A5%91%E7%BA%A6%E6%AF%8F%E6%97%A5%E5%95%86%E5%BA%97.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>无畏契约每日商店</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%A3%81%E9%93%BE%E8%A7%A3%E6%9E%90%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>磁链解析插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%94%A8%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80AI%E7%82%B9%E6%AD%8C.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>用自然语言AI点歌</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%93%88%E5%9F%BA%E7%B1%B3%E8%AF%AD%E9%9F%B3.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>哈基米语音</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/AI%E8%87%AA%E4%B8%BB%E7%AE%A1%E7%90%86%E7%BE%A4%E8%81%8A.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>AI自主管理群聊</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/CS%E9%A5%B0%E5%93%81%E6%9F%A5%E8%AF%A2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>CS饰品查询</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%9F%BA%E4%BA%8EAI%E7%9A%84Galgame%E4%BA%92%E5%8A%A8%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>基于AI的Galgame互动插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E5%8A%A8%E6%BC%AB%E7%A3%81%E9%93%BE%E6%9F%A5%E8%AF%A2%E6%8F%92%E4%BB%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>动漫磁链查询插件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/%E7%8B%BC%E4%BA%BA%E6%9D%80%E6%B8%B8%E6%88%8F.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>狼人杀游戏</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _%E8%A7%86%E9%A2%91%E5%88%86%E6%9E%90" data-v-e6f2a212><div><h1 id="astrbot-gemini-video-plugin-🎬" tabindex="-1">AstrBot Gemini Video Plugin 🎬 <a class="header-anchor" href="#astrbot-gemini-video-plugin-🎬" aria-label="Permalink to &quot;AstrBot Gemini Video Plugin 🎬&quot;">​</a></h1><p><a href="https://github.com/Soulter/AstrBot" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/AstrBot-v3.0+-blue.svg" alt="AstrBot"></a><a href="#"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License"></a></p><blockquote><p>💬 <strong>加入QQ群获取支持</strong>：<a href="https://qun.qq.com/universal-share/share?ac=1&amp;authKey=fqH3xeXAFOlK6983ACfvuMn1uK9cnK8KEwU9p7mprX3DXHncn3uVx%2BcnGmphv%2BZK&amp;busi_data=eyJncm91cENvZGUiOiIzMDg3NDk4MTAiLCJ0b2tlbiI6Ilp4dnk1anEySG9Wdzg1NEI0ZmZ2NkVYcXIwb3QvQ3VNKzNwMGNLYlQ4aGlvTzdJdUJDY011V3hXUjI0cUlRMTUiLCJ1aW4iOiIyMTQ4MTkzNDU4In0=&amp;data=6bw6cjWn50SQWIAWQ9nhxMn1xCHo62sPn4oJP3qWfes7lRZXBAZq1UPnfa31fKPMhMZcQxuIqDA4IildMyb6u_TQHVCntNf4tvSZeFN6D9U&amp;svctype=5&amp;tempid=h5_group_info" target="_blank" rel="noreferrer">点击加入 308749810</a> 🚀</p></blockquote><p>一个为 AstrBot 设计的<strong>高性能、高可靠性</strong> Gemini 视频分析插件。支持多种上传模式、自动压缩、智能网络优化，完美兼容 Agent 工具调用与人格注入。</p><blockquote><p>🎯 <strong>优化重点</strong>：经过深度优化的下载逻辑、上传可靠性、视频压缩，以及针对 QQ/腾讯 CDN 的智能直连优化。</p></blockquote><h2 id="✨-核心特性" tabindex="-1">✨ 核心特性 <a class="header-anchor" href="#✨-核心特性" aria-label="Permalink to &quot;✨ 核心特性&quot;">​</a></h2><h3 id="🚀-智能上传策略" tabindex="-1">🚀 智能上传策略 <a class="header-anchor" href="#🚀-智能上传策略" aria-label="Permalink to &quot;🚀 智能上传策略&quot;">​</a></h3><ul><li><strong>Base64 编码上传</strong>：适用于中小型视频（≤30MB），兼容性最广，能有效绕过部分中转服务商的文件上传限制</li><li><strong>File API 上传</strong>：适用于大型视频，先上传到 API 服务器获取 CDN URL，再进行分析</li><li><strong>自动压缩</strong>：视频超过阈值（默认25MB）时自动调用 <code>ffmpeg</code> 压缩为 720p/CRF28，大幅提高上传成功率</li></ul><h3 id="🎭-深度人格注入" tabindex="-1">🎭 深度人格注入 <a class="header-anchor" href="#🎭-深度人格注入" aria-label="Permalink to &quot;🎭 深度人格注入&quot;">​</a></h3><ul><li>采用 <strong>Double Injection</strong> 策略，将 Gemini 的客观分析与用户配置的人格设定深度融合</li><li>确保机器人的回复既专业准确，又符合其角色性格（如亚托莉的少女萝卜子语气）</li></ul><h3 id="🔄-强制刷新机制" tabindex="-1">🔄 强制刷新机制 <a class="header-anchor" href="#🔄-强制刷新机制" aria-label="Permalink to &quot;🔄 强制刷新机制&quot;">​</a></h3><ul><li>每次分析都触发<strong>强制重新下载</strong>和<strong>重新分析</strong></li><li>不依赖过时的本地缓存，确保获取视频的最新内容</li><li>适用于实时更新的视频内容场景</li></ul><h3 id="🌐-网络优化与可靠性" tabindex="-1">🌐 网络优化与可靠性 <a class="header-anchor" href="#🌐-网络优化与可靠性" aria-label="Permalink to &quot;🌐 网络优化与可靠性&quot;">​</a></h3><ul><li><strong>智能代理绕过</strong>：自动检测 QQ/腾讯 CDN 域名（<code>.qq.com</code>、<code>.qq.com.cn</code>、<code>.tencent.com</code>），强制直连以获得最佳速度</li><li><strong>多轮重试机制</strong>：下载、上传均支持可配置的重试次数和间隔</li><li><strong>超时监控</strong>：实时监控下载速度和上传进度，防止卡死</li><li><strong>OneBot 协议兼容</strong>：支持 <code>get_file</code> 和 <code>download_file</code> 接口，解析文件 ID 为真实 URL/路径</li></ul><h3 id="🤖-agent-工具集成" tabindex="-1">🤖 Agent 工具集成 <a class="header-anchor" href="#🤖-agent-工具集成" aria-label="Permalink to &quot;🤖 Agent 工具集成&quot;">​</a></h3><ul><li><strong>函数工具调用</strong>：注册为 <code>gemini_analyze_video</code> 工具，LLM 可自动调用</li><li><strong>Reply 消息优先</strong>：当用户回复（Reply）包含视频的消息时，优先分析被引用的视频，而非从聊天历史中错误提取</li><li><strong>即时反馈</strong>：调用工具时立即发送&quot;正在分析...&quot;提示（可自定义 <code>watching_hint</code>）</li></ul><h3 id="🧹-自动维护" tabindex="-1">🧹 自动维护 <a class="header-anchor" href="#🧹-自动维护" aria-label="Permalink to &quot;🧹 自动维护&quot;">​</a></h3><ul><li>后台清理任务定期删除过期视频（默认3天）</li><li>支持自定义清理间隔（默认6小时）</li><li>磁盘空间无忧</li></ul><h3 id="💬-完美配套" tabindex="-1">💬 完美配套 <a class="header-anchor" href="#💬-完美配套" aria-label="Permalink to &quot;💬 完美配套&quot;">​</a></h3><ul><li>兼容 <code>Splitter</code> 插件（分段回复）</li><li>兼容 AstrBot 内置 TTS 系统</li><li>支持流式响应和 SSE 格式</li></ul><hr><h2 id="📦-安装方法" tabindex="-1">📦 安装方法 <a class="header-anchor" href="#📦-安装方法" aria-label="Permalink to &quot;📦 安装方法&quot;">​</a></h2><h3 id="方式一-通过-astrbot-管理面板-推荐" tabindex="-1">方式一：通过 AstrBot 管理面板（推荐） <a class="header-anchor" href="#方式一-通过-astrbot-管理面板-推荐" aria-label="Permalink to &quot;方式一：通过 AstrBot 管理面板（推荐）&quot;">​</a></h3><ol><li>打开 AstrBot Web 管理面板</li><li>导航到&quot;插件&quot; → &quot;安装插件&quot;</li><li>输入仓库地址：<div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://github.com/Liangyu-G/astrbot_plugin_gemini-video</span></span></code></pre></div></li><li>等待安装完成，重启机器人</li></ol><h3 id="方式二-手动安装" tabindex="-1">方式二：手动安装 <a class="header-anchor" href="#方式二-手动安装" aria-label="Permalink to &quot;方式二：手动安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AstrBot/data/plugins</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/Liangyu-G/astrbot_plugin_gemini-video</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重启 AstrBot</span></span></code></pre></div><h3 id="依赖要求" tabindex="-1">依赖要求 <a class="header-anchor" href="#依赖要求" aria-label="Permalink to &quot;依赖要求&quot;">​</a></h3><ul><li><strong>FFmpeg</strong>（可选，但强烈推荐）：用于视频压缩功能 <ul><li>Windows: 下载 FFmpeg，添加到 PATH</li><li>Linux/macOS: <code>apt install ffmpeg</code> 或 <code>brew install ffmpeg</code></li></ul></li></ul><hr><h2 id="⚙️-配置详解" tabindex="-1">⚙️ 配置详解 <a class="header-anchor" href="#⚙️-配置详解" aria-label="Permalink to &quot;⚙️ 配置详解&quot;">​</a></h2><h3 id="基本配置" tabindex="-1">基本配置 <a class="header-anchor" href="#基本配置" aria-label="Permalink to &quot;基本配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>base_url</code></td><td style="text-align:left;">Gemini API 基础 URL</td><td style="text-align:left;"><em>必填</em></td><td style="text-align:left;">支持官方 API 和第三方中转（如柏拉图）</td></tr><tr><td style="text-align:left;"><code>api_key</code></td><td style="text-align:left;">API 密钥</td><td style="text-align:left;"><em>必填</em></td><td style="text-align:left;">确保有充足的配额</td></tr><tr><td style="text-align:left;"><code>model</code></td><td style="text-align:left;">使用的模型</td><td style="text-align:left;"><code>gemini-3-flash-preview</code></td><td style="text-align:left;">推荐 flash 系列，速度快</td></tr><tr><td style="text-align:left;"><code>max_tokens</code></td><td style="text-align:left;">最大生成 Token 数</td><td style="text-align:left;"><code>4000</code></td><td style="text-align:left;">分析结果的长度限制</td></tr></tbody></table><h3 id="上传模式配置" tabindex="-1">上传模式配置 <a class="header-anchor" href="#上传模式配置" aria-label="Permalink to &quot;上传模式配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>upload_mode</code></td><td style="text-align:left;">上传模式</td><td style="text-align:left;"><code>base64</code></td><td style="text-align:left;"><code>base64</code> 或 <code>file_api</code></td></tr><tr><td style="text-align:left;"><code>max_base64_size_mb</code></td><td style="text-align:left;">Base64 模式最大文件大小</td><td style="text-align:left;"><code>30</code></td><td style="text-align:left;">建议 20-30MB</td></tr><tr><td style="text-align:left;"><code>upload_retries</code></td><td style="text-align:left;">上传重试次数</td><td style="text-align:left;"><code>3</code></td><td style="text-align:left;">网络不稳定时可增加</td></tr><tr><td style="text-align:left;"><code>upload_stream_timeout</code></td><td style="text-align:left;">上传流超时（秒）</td><td style="text-align:left;"><code>3600</code></td><td style="text-align:left;">File API 模式推荐 ≥600s</td></tr></tbody></table><h3 id="视频压缩配置" tabindex="-1">视频压缩配置 <a class="header-anchor" href="#视频压缩配置" aria-label="Permalink to &quot;视频压缩配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>enable_compression</code></td><td style="text-align:left;">是否启用自动压缩</td><td style="text-align:left;"><code>true</code></td><td style="text-align:left;">需要安装 FFmpeg</td></tr><tr><td style="text-align:left;"><code>compression_threshold_mb</code></td><td style="text-align:left;">压缩触发阈值（MB）</td><td style="text-align:left;"><code>25</code></td><td style="text-align:left;">超过此大小自动压缩</td></tr></tbody></table><p><strong>压缩策略</strong>：</p><ul><li>分辨率：缩放到 720p（保持宽高比）</li><li>编码：H.264，CRF 28（平衡质量与文件大小）</li><li>通常可减小文件 60-80%</li></ul><h3 id="下载与网络配置" tabindex="-1">下载与网络配置 <a class="header-anchor" href="#下载与网络配置" aria-label="Permalink to &quot;下载与网络配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><code>download_retries</code></td><td style="text-align:left;">下载重试次数</td><td style="text-align:left;"><code>3</code></td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;"><code>download_retry_delay</code></td><td style="text-align:left;">重试间隔（秒）</td><td style="text-align:left;"><code>5</code></td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;"><code>download_stream_timeout</code></td><td style="text-align:left;">下载流超时（秒）</td><td style="text-align:left;"><code>300</code></td><td style="text-align:left;">大视频可适当增加</td></tr><tr><td style="text-align:left;"><code>proxy</code></td><td style="text-align:left;">HTTP 代理地址</td><td style="text-align:left;"><em>空</em></td><td style="text-align:left;">格式：<code>http://host:port</code></td></tr></tbody></table><p><strong>智能代理绕过</strong>：</p><ul><li>QQ/腾讯 CDN 域名（如 <code>multimedia.nt.qq.com.cn</code>）会自动绕过代理，强制直连</li><li>提高国内视频下载速度</li></ul><h3 id="其他配置" tabindex="-1">其他配置 <a class="header-anchor" href="#其他配置" aria-label="Permalink to &quot;其他配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">配置项</th><th style="text-align:left;">说明</th><th style="text-align:left;">默认值</th></tr></thead><tbody><tr><td style="text-align:left;"><code>default_prompt</code></td><td style="text-align:left;">默认分析提示词</td><td style="text-align:left;"><em>详细分析提示</em></td></tr><tr><td style="text-align:left;"><code>watching_hint</code></td><td style="text-align:left;">分析中的提示文本</td><td style="text-align:left;"><code>亚托莉正在看视频哦~</code></td></tr><tr><td style="text-align:left;"><code>video_retention_days</code></td><td style="text-align:left;">视频保留天数</td><td style="text-align:left;"><code>3</code></td></tr><tr><td style="text-align:left;"><code>cleanup_interval_hours</code></td><td style="text-align:left;">清理检查间隔（小时）</td><td style="text-align:left;"><code>6</code></td></tr><tr><td style="text-align:left;"><code>max_video_size_mb</code></td><td style="text-align:left;">允许的最大视频大小</td><td style="text-align:left;"><code>100</code></td></tr></tbody></table><hr><h2 id="📖-使用指南" tabindex="-1">📖 使用指南 <a class="header-anchor" href="#📖-使用指南" aria-label="Permalink to &quot;📖 使用指南&quot;">​</a></h2><h3 id="方式一-命令触发" tabindex="-1">方式一：命令触发 <a class="header-anchor" href="#方式一-命令触发" aria-label="Permalink to &quot;方式一：命令触发&quot;">​</a></h3><p><strong>直接分析视频</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 发送视频到群/私聊</span></span>
<span class="line"><span>2. 发送命令：/分析视频</span></span></code></pre></div><p><strong>引用视频分析</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 回复（Reply）包含视频的消息</span></span>
<span class="line"><span>2. 发送：/分析视频 请分析这个视频的剪辑技巧</span></span></code></pre></div><p><strong>自定义提示词</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/分析视频 分析这个视频的音乐风格和情绪表达</span></span></code></pre></div><h3 id="方式二-llm-工具调用-推荐" tabindex="-1">方式二：LLM 工具调用（推荐） <a class="header-anchor" href="#方式二-llm-工具调用-推荐" aria-label="Permalink to &quot;方式二：LLM 工具调用（推荐）&quot;">​</a></h3><p>如果您的主 LLM 支持 Function Calling（如 GPT-4、Claude、Gemini），可以直接在对话中说：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>- &quot;帮我看看这个视频讲了什么&quot;</span></span>
<span class="line"><span>- &quot;分析一下刚才那个视频的拍摄手法&quot;</span></span>
<span class="line"><span>- &quot;这个视频里的 AI 在讨论什么话题？&quot;</span></span></code></pre></div><p><strong>工作流程</strong>：</p><ol><li>LLM 识别用户意图，调用 <code>gemini_analyze_video</code> 工具</li><li>插件发送&quot;正在分析...&quot;提示（立即反馈）</li><li>下载视频 → 压缩（如需要）→ 上传 → 调用 Gemini API</li><li>返回分析结果给 LLM</li><li>LLM 基于分析结果，以设定的人格语气回复用户</li></ol><p><strong>Reply 消息优先机制</strong>：</p><ul><li>当您回复（Reply）一个包含视频的消息时，插件<strong>优先分析被引用的视频</strong></li><li>即使 LLM 从聊天历史中提取了其他 URL，也会被忽略</li><li>确保&quot;分析的就是您想要的那个视频&quot;</li></ul><hr><h2 id="🔧-工作原理" tabindex="-1">🔧 工作原理 <a class="header-anchor" href="#🔧-工作原理" aria-label="Permalink to &quot;🔧 工作原理&quot;">​</a></h2><h3 id="视频定位逻辑" tabindex="-1">视频定位逻辑 <a class="header-anchor" href="#视频定位逻辑" aria-label="Permalink to &quot;视频定位逻辑&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 优先检查 Reply 消息中的视频（从缓存或 chain 获取）</span></span>
<span class="line"><span>2. 检查当前消息中的视频</span></span>
<span class="line"><span>3. LLM 提供的 URL（仅作为后备）</span></span></code></pre></div><h3 id="下载流程" tabindex="-1">下载流程 <a class="header-anchor" href="#下载流程" aria-label="Permalink to &quot;下载流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检测 URL 类型：</span></span>
<span class="line"><span>   - file:/// → 直接使用本地路径</span></span>
<span class="line"><span>   - HTTP URL → 进入下载流程</span></span>
<span class="line"><span>   - 文件名/ID → 调用 OneBot get_file 解析</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>2. 智能代理判断：</span></span>
<span class="line"><span>   - QQ/腾讯域名 → 强制直连</span></span>
<span class="line"><span>   - 其他域名 → 使用配置的 proxy</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>3. 下载监控：</span></span>
<span class="line"><span>   - 每10秒检查速度</span></span>
<span class="line"><span>   - 停滞检测（30秒无数据传输则报错）</span></span>
<span class="line"><span>   - 支持多轮重试</span></span></code></pre></div><h3 id="上传与分析流程" tabindex="-1">上传与分析流程 <a class="header-anchor" href="#上传与分析流程" aria-label="Permalink to &quot;上传与分析流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检查文件大小</span></span>
<span class="line"><span>2. 触发压缩（如超过阈值）</span></span>
<span class="line"><span>3. 根据 upload_mode 选择模式：</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>   Base64 模式：</span></span>
<span class="line"><span>   - 检查大小 ≤ max_base64_size_mb</span></span>
<span class="line"><span>   - Base64 编码</span></span>
<span class="line"><span>   - 构造 data URI</span></span>
<span class="line"><span>   - 调用 OpenAI 兼容 API</span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>   File API 模式：</span></span>
<span class="line"><span>   - 上传到 /v1/files 端点</span></span>
<span class="line"><span>   - 获取 file_uri</span></span>
<span class="line"><span>   - 轮询文件状态（等待 ACTIVE）</span></span>
<span class="line"><span>   - 调用 Gemini Native API</span></span></code></pre></div><h3 id="人格注入策略-double-injection" tabindex="-1">人格注入策略（Double Injection） <a class="header-anchor" href="#人格注入策略-double-injection" aria-label="Permalink to &quot;人格注入策略（Double Injection）&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">final_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[System Instruction: You are </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">system_prompt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Context: The user sent a video. Here is a description of the video content:]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gemini_analysis_result</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[User Request: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user_prompt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Task: Reply to the User Request based on the video description. </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Important: You must ACT AS your persona. Do NOT act as an AI assistant. Stay in character.]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span></code></pre></div><hr><h2 id="❓-常见问题与故障排查" tabindex="-1">❓ 常见问题与故障排查 <a class="header-anchor" href="#❓-常见问题与故障排查" aria-label="Permalink to &quot;❓ 常见问题与故障排查&quot;">​</a></h2><h3 id="q1-提示-视频分析失败-未能获取分析结果" tabindex="-1">Q1: 提示&quot;视频分析失败，未能获取分析结果&quot; <a class="header-anchor" href="#q1-提示-视频分析失败-未能获取分析结果" aria-label="Permalink to &quot;Q1: 提示&quot;视频分析失败，未能获取分析结果&quot;&quot;">​</a></h3><p><strong>可能原因</strong>：</p><ol><li>API Key 无效或配额不足</li><li>Base URL 配置错误</li><li>网络连接问题（无法访问 API）</li></ol><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检查 api_key 是否正确</span></span>
<span class="line"><span>2. 尝试访问 base_url（如 curl https://api.bltcy.ai）</span></span>
<span class="line"><span>3. 如使用代理，检查 proxy 配置</span></span>
<span class="line"><span>4. 查看日志中的详细错误信息</span></span></code></pre></div><h3 id="q2-下载速度极慢-50-kb-s" tabindex="-1">Q2: 下载速度极慢（&lt;50 KB/s） <a class="header-anchor" href="#q2-下载速度极慢-50-kb-s" aria-label="Permalink to &quot;Q2: 下载速度极慢（&lt;50 KB/s）&quot;">​</a></h3><p><strong>可能原因</strong>：</p><ol><li>QQ CDN 域名未被正确识别为国内域名</li><li>网络环境限制（运营商 QoS）</li><li>服务器端限流</li></ol><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 查看日志，确认是否有&quot;检测到国内域名，强制直连&quot;</span></span>
<span class="line"><span>2. 如果没有，检查 main.py:559 的域名匹配逻辑</span></span>
<span class="line"><span>3. 尝试清空 proxy 配置（国内视频不需要代理）</span></span>
<span class="line"><span>4. 考虑使用 OneBot 的 download_file API（如支持）</span></span></code></pre></div><h3 id="q3-上传失败-提示-77-处停滞" tabindex="-1">Q3: 上传失败，提示 77% 处停滞 <a class="header-anchor" href="#q3-上传失败-提示-77-处停滞" aria-label="Permalink to &quot;Q3: 上传失败，提示 77% 处停滞&quot;">​</a></h3><p><strong>可能原因</strong>：</p><ul><li>服务器端超时（通常为 120 秒）</li><li>本地代理的超时限制</li></ul><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 启用视频压缩：enable_compression = true</span></span>
<span class="line"><span>2. 减小 compression_threshold_mb（如 20）</span></span>
<span class="line"><span>3. 切换到 file_api 模式（如中转支持）</span></span>
<span class="line"><span>4. 增加 upload_stream_timeout</span></span>
<span class="line"><span>5. 如使用本地代理，调整代理的超时设置</span></span></code></pre></div><h3 id="q4-ffmpeg-未找到-压缩失败" tabindex="-1">Q4: FFmpeg 未找到，压缩失败 <a class="header-anchor" href="#q4-ffmpeg-未找到-压缩失败" aria-label="Permalink to &quot;Q4: FFmpeg 未找到，压缩失败&quot;">​</a></h3><p><strong>现象</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Gemini Video] FFmpeg not found, skipping compression</span></span></code></pre></div><p><strong>解决方案</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">下载</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FFmpeg，解压后将</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 目录添加到系统</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PATH</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 验证安装</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ffmpeg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><h3 id="q5-base64-模式提示文件过大" tabindex="-1">Q5: Base64 模式提示文件过大 <a class="header-anchor" href="#q5-base64-模式提示文件过大" aria-label="Permalink to &quot;Q5: Base64 模式提示文件过大&quot;">​</a></h3><p><strong>错误示例</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>❌ 视频文件过大 (35.2MB)，Base64 模式最大支持 30MB</span></span></code></pre></div><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>方案一：启用压缩</span></span>
<span class="line"><span>- enable_compression: true</span></span>
<span class="line"><span>- compression_threshold_mb: 25</span></span>
<span class="line"><span></span></span>
<span class="line"><span>方案二：切换上传模式</span></span>
<span class="line"><span>- upload_mode: &quot;file_api&quot;</span></span>
<span class="line"><span>（需要 API 支持 /v1/files 端点）</span></span>
<span class="line"><span></span></span>
<span class="line"><span>方案三：调整限制（不推荐）</span></span>
<span class="line"><span>- max_base64_size_mb: 50</span></span>
<span class="line"><span>（可能导致请求失败）</span></span></code></pre></div><h3 id="q6-分析的是错误的视频-聊天历史中的旧视频" tabindex="-1">Q6: 分析的是错误的视频（聊天历史中的旧视频） <a class="header-anchor" href="#q6-分析的是错误的视频-聊天历史中的旧视频" aria-label="Permalink to &quot;Q6: 分析的是错误的视频（聊天历史中的旧视频）&quot;">​</a></h3><p><strong>原因</strong>：</p><ul><li>LLM 从聊天历史中提取了旧视频的 URL</li></ul><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>插件已修复此问题（v1.1.0+）：</span></span>
<span class="line"><span>- 现在优先检查 Reply 消息中的视频</span></span>
<span class="line"><span>- LLM 提供的 URL 仅作为后备</span></span>
<span class="line"><span>- 确保更新到最新版本</span></span></code></pre></div><h3 id="q7-onebot-平台视频下载失败" tabindex="-1">Q7: OneBot 平台视频下载失败 <a class="header-anchor" href="#q7-onebot-平台视频下载失败" aria-label="Permalink to &quot;Q7: OneBot 平台视频下载失败&quot;">​</a></h3><p><strong>错误示例</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>UnsupportedProtocol: Request URL is missing an &#39;http://&#39; or &#39;https://&#39; protocol</span></span></code></pre></div><p><strong>原因</strong>：</p><ul><li>OneBot 返回的是文件 ID（如 <code>abc123.mp4</code>），不是 URL</li></ul><p><strong>解决方案</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>插件已自动处理（v1.1.0+）：</span></span>
<span class="line"><span>- 自动调用 get_file 接口解析文件 ID</span></span>
<span class="line"><span>- 确保 OneBot 实现（如 LLOneBot）支持 get_file</span></span>
<span class="line"><span>- 查看日志确认是否成功解析</span></span></code></pre></div><hr><h2 id="🔍-配置示例" tabindex="-1">🔍 配置示例 <a class="header-anchor" href="#🔍-配置示例" aria-label="Permalink to &quot;🔍 配置示例&quot;">​</a></h2><h3 id="示例一-国内环境-柏拉图-api-推荐" tabindex="-1">示例一：国内环境 + 柏拉图 API（推荐） <a class="header-anchor" href="#示例一-国内环境-柏拉图-api-推荐" aria-label="Permalink to &quot;示例一：国内环境 + 柏拉图 API（推荐）&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;base_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.bltcy.ai&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;api_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;your_api_key_here&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;model&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gemini-3-flash-preview&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;base64&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;max_base64_size_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;enable_compression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compression_threshold_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;download_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="示例二-国外环境-官方-api" tabindex="-1">示例二：国外环境 + 官方 API <a class="header-anchor" href="#示例二-国外环境-官方-api" aria-label="Permalink to &quot;示例二：国外环境 + 官方 API&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;base_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://generativelanguage.googleapis.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;api_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AIza...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;model&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gemini-2.5-flash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_mode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file_api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;enable_compression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:7890&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_stream_timeout&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="示例三-网络不稳定环境" tabindex="-1">示例三：网络不稳定环境 <a class="header-anchor" href="#示例三-网络不稳定环境" aria-label="Permalink to &quot;示例三：网络不稳定环境&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;upload_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;download_retries&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;download_retry_delay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;enable_compression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compression_threshold_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;max_base64_size_mb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="🛠️-技术细节" tabindex="-1">🛠️ 技术细节 <a class="header-anchor" href="#🛠️-技术细节" aria-label="Permalink to &quot;🛠️ 技术细节&quot;">​</a></h2><h3 id="依赖库" tabindex="-1">依赖库 <a class="header-anchor" href="#依赖库" aria-label="Permalink to &quot;依赖库&quot;">​</a></h3><ul><li><code>httpx</code>: HTTP 客户端（支持流式下载/上传、代理）</li><li><code>asyncio</code>: 异步 I/O</li><li><code>ffmpeg</code>: 视频压缩（外部依赖）</li><li><code>pathlib</code>: 路径操作</li><li><code>base64</code>: Base64 编码</li></ul><h3 id="性能特性" tabindex="-1">性能特性 <a class="header-anchor" href="#性能特性" aria-label="Permalink to &quot;性能特性&quot;">​</a></h3><ul><li><strong>异步下载</strong>：使用 <code>aiter_bytes()</code> 流式下载，内存友好</li><li><strong>并发控制</strong>：URL 级别的下载锁，防止重复下载</li><li><strong>智能缓存</strong>：消息级别的视频路径缓存</li><li><strong>后台清理</strong>：独立的 <code>asyncio.Task</code> 定期清理过期文件</li></ul><h3 id="安全特性" tabindex="-1">安全特性 <a class="header-anchor" href="#安全特性" aria-label="Permalink to &quot;安全特性&quot;">​</a></h3><ul><li>API Key 日志脱敏（显示为 <code>********</code>）</li><li>临时文件自动清理</li><li>文件大小限制（防止磁盘占用过大）</li></ul><hr><h2 id="📝-更新日志" tabindex="-1">📝 更新日志 <a class="header-anchor" href="#📝-更新日志" aria-label="Permalink to &quot;📝 更新日志&quot;">​</a></h2><h3 id="v1-1-0-2026-01-10" tabindex="-1">v1.1.0 (2026-01-10) <a class="header-anchor" href="#v1-1-0-2026-01-10" aria-label="Permalink to &quot;v1.1.0 (2026-01-10)&quot;">​</a></h3><ul><li>✨ 新增：自动视频压缩（ffmpeg）</li><li>✨ 新增：可配置的上传重试和 Base64 大小限制</li><li>🐛 修复：Reply 消息优先级问题（不再分析错误的视频）</li><li>🐛 修复：QQ CDN 域名检测（支持 <code>.qq.com.cn</code>）</li><li>🐛 修复：OneBot 文件 ID 解析（支持 <code>get_file</code>）</li><li>🐛 修复：Agent 工具调用的即时反馈</li><li>⚡ 优化：智能代理绕过逻辑</li><li>⚡ 优化：下载速度监控和停滞检测</li><li>📝 文档：全面更新 README 和配置说明</li></ul><h3 id="v1-0-0-初始版本" tabindex="-1">v1.0.0 (初始版本) <a class="header-anchor" href="#v1-0-0-初始版本" aria-label="Permalink to &quot;v1.0.0 (初始版本)&quot;">​</a></h3><ul><li>基础功能实现</li></ul><hr><h2 id="🤝-贡献与支持" tabindex="-1">🤝 贡献与支持 <a class="header-anchor" href="#🤝-贡献与支持" aria-label="Permalink to &quot;🤝 贡献与支持&quot;">​</a></h2><h3 id="💬-qq交流群" tabindex="-1">💬 QQ交流群 <a class="header-anchor" href="#💬-qq交流群" aria-label="Permalink to &quot;💬 QQ交流群&quot;">​</a></h3><p><strong>遇到问题？想要交流经验？加入我们的QQ群！</strong></p><ul><li><strong>群号</strong>：308749810</li><li><strong>加群链接</strong>：<a href="https://qun.qq.com/universal-share/share?ac=1&amp;authKey=fqH3xeXAFOlK6983ACfvuMn1uK9cnK8KEwU9p7mprX3DXHncn3uVx%2BcnGmphv%2BZK&amp;busi_data=eyJncm91cENvZGUiOiIzMDg3NDk4MTAiLCJ0b2tlbiI6Ilp4dnk1anEySG9Wdzg1NEI0ZmZ2NkVYcXIwb3QvQ3VNKzNwMGNLYlQ4aGlvTzdJdUJDY011V3hXUjI0cUlRMTUiLCJ1aW4iOiIyMTQ4MTkzNDU4In0=&amp;data=6bw6cjWn50SQWIAWQ9nhxMn1xCHo62sPn4oJP3qWfes7lRZXBAZq1UPnfa31fKPMhMZcQxuIqDA4IildMyb6u_TQHVCntNf4tvSZeFN6D9U&amp;svctype=5&amp;tempid=h5_group_info" target="_blank" rel="noreferrer">点击加入</a> 🚀</li></ul><p>在群里可以：</p><ul><li>💡 快速获取技术支持</li><li>🐛 反馈Bug和问题</li><li>💬 与其他用户交流使用经验</li><li>🎯 提出功能建议</li><li>📢 获取最新版本发布通知</li></ul><h3 id="问题反馈" tabindex="-1">问题反馈 <a class="header-anchor" href="#问题反馈" aria-label="Permalink to &quot;问题反馈&quot;">​</a></h3><p>遇到问题？请提交 Issue： <a href="https://github.com/Liangyu-G/astrbot_plugin_gemini-video/issues" target="_blank" rel="noreferrer">https://github.com/Liangyu-G/astrbot_plugin_gemini-video/issues</a></p><h3 id="功能建议" tabindex="-1">功能建议 <a class="header-anchor" href="#功能建议" aria-label="Permalink to &quot;功能建议&quot;">​</a></h3><p>欢迎提交 Feature Request 或 Pull Request！</p><h3 id="测试环境" tabindex="-1">测试环境 <a class="header-anchor" href="#测试环境" aria-label="Permalink to &quot;测试环境&quot;">​</a></h3><ul><li>✅ LLOneBot + 柏拉图 API</li><li>⚠️ 其他平台未充分测试，欢迎反馈兼容性问题</li></ul><hr><h2 id="📄-许可证" tabindex="-1">📄 许可证 <a class="header-anchor" href="#📄-许可证" aria-label="Permalink to &quot;📄 许可证&quot;">​</a></h2><p>MIT License</p><hr><p><strong>Love and Robots — 毕竟，亚托莉可是高性能的嘛！</strong> 🤖💖</p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/%E6%8D%90%E8%B5%A0.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>捐赠</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/ZeroBot.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>功能大合集</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai智能定时任务插件.md\":\"yuVQkMQ0\",\"ai画图.md\":\"adem7S3s\",\"ai自主管理群聊.md\":\"Puri3zQu\",\"ai表情包管理器.md\":\"DAdY3Ec-\",\"cs饰品查询.md\":\"C0UCaTaj\",\"index.md\":\"Drkbibgb\",\"one last kiss 风格生成器.md\":\"DwUkAbpj\",\"qq群日常分析插件.md\":\"Blz8NkKO\",\"qq违规记录查询.md\":\"BNSMGmkv\",\"rsshub.md\":\"BbpenaMi\",\"sora 模型生成视频.md\":\"CyWThPJw\",\"steam价格查询插件.md\":\"Sz9tXpcc\",\"steam截图.md\":\"C7nP538c\",\"token使用监控与管理.md\":\"C5ra75cp\",\"url摘要提取器.md\":\"DKWK_Ziv\",\"zerobot.md\":\"PxsSA4kl\",\"五子棋游戏.md\":\"BEX_tzLe\",\"人生重开模拟器.md\":\"vPxaSrZv\",\"俄罗斯轮盘赌.md\":\"C1pW27Kx\",\"关键词自动回复.md\":\"BAbtdUQ6\",\"动态文字冒险.md\":\"B8gbk_Ms\",\"动漫磁链查询插件.md\":\"BYA2-6d_\",\"哈基米语音.md\":\"B249OU8p\",\"基于ai的galgame互动插件.md\":\"CwtGXoDt\",\"导管记录.md\":\"D1LWpS-M\",\"幻影坦克.md\":\"CXrUNWFu\",\"广播助手.md\":\"DHDd-R4R\",\"开盒群友.md\":\"CsTFvIZk\",\"德州扑克.md\":\"DGIqEii3\",\"戳一戳.md\":\"CBfFq3mr\",\"打胶.md\":\"B7mjuZ83\",\"捐赠.md\":\"i_7ImqoO\",\"搜图与色图.md\":\"77K_7rdN\",\"操控bot的便捷命令.md\":\"7uzcvBcy\",\"无畏契约每日商店.md\":\"BVzqCM2V\",\"智能合并转发分析插件.md\":\"C30ZtniV\",\"狼人杀游戏.md\":\"Bt9ScQLN\",\"猜cs职业选手.md\":\"D2vUyKZZ\",\"猪猪表情包.md\":\"Dpd3Pbuy\",\"用自然语言ai点歌.md\":\"C-gLO6rL\",\"硬件信息查询.md\":\"BOeBoQ7V\",\"磁链解析插件.md\":\"CMhFrWsL\",\"禁漫下载.md\":\"D5Q8RD93\",\"禁漫搜索.md\":\"BqmZ1jiW\",\"群成员查询插件.md\":\"CRqpUk5f\",\"色情沉浸式互动控制插件.md\":\"AIDA4sl4\",\"裁剪和合并gif.md\":\"DPtYvhUt\",\"视频分析.md\":\"CAwGu9K8\",\"解析流媒体平台链接.md\":\"qso1iucZ\",\"评价qq头像.md\":\"C86ZDANO\",\"骗子酒馆.md\":\"CBtp4o8q\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"ATRI -My Dear Moments-\",\"description\":\"A VitePress Site\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"主页\",\"link\":\"/\"},{\"text\":\"功能页\",\"link\":\"/ZeroBot\"}],\"sidebar\":[{\"text\":\"功能列表\",\"items\":[{\"text\":\"捐赠\",\"link\":\"/捐赠\"},{\"text\":\"视频分析\",\"link\":\"/视频分析\"},{\"text\":\"功能大合集\",\"link\":\"/ZeroBot\"},{\"text\":\"禁漫下载\",\"link\":\"/禁漫下载\"},{\"text\":\"禁漫搜索\",\"link\":\"/禁漫搜索\"},{\"text\":\"搜图与色图\",\"link\":\"/搜图与色图\"},{\"text\":\"Steam价格查询插件\",\"link\":\"/Steam价格查询插件\"},{\"text\":\"广播助手\",\"link\":\"/广播助手\"},{\"text\":\"智能合并转发分析插件\",\"link\":\"/智能合并转发分析插件\"},{\"text\":\"猜CS职业选手\",\"link\":\"/猜CS职业选手\"},{\"text\":\"骗子酒馆\",\"link\":\"/骗子酒馆\"},{\"text\":\"AI表情包管理器\",\"link\":\"/AI表情包管理器\"},{\"text\":\"戳一戳\",\"link\":\"/戳一戳\"},{\"text\":\"Steam截图\",\"link\":\"/Steam截图\"},{\"text\":\"动态文字冒险\",\"link\":\"/动态文字冒险\"},{\"text\":\"QQ群日常分析插件\",\"link\":\"/QQ群日常分析插件\"},{\"text\":\"德州扑克\",\"link\":\"/德州扑克\"},{\"text\":\"色情沉浸式互动控制插件\",\"link\":\"/色情沉浸式互动控制插件\"},{\"text\":\"打胶\",\"link\":\"/打胶\"},{\"text\":\"俄罗斯轮盘赌\",\"link\":\"/俄罗斯轮盘赌\"},{\"text\":\"操控BOT的便捷命令\",\"link\":\"/操控BOT的便捷命令\"},{\"text\":\"幻影坦克\",\"link\":\"/幻影坦克\"},{\"text\":\"人生重开模拟器\",\"link\":\"/人生重开模拟器\"},{\"text\":\"RSSHub\",\"link\":\"/RSSHub\"},{\"text\":\"URL摘要提取器\",\"link\":\"/URL摘要提取器\"},{\"text\":\"导管记录\",\"link\":\"/导管记录\"},{\"text\":\"One Last Kiss 风格生成器\",\"link\":\"/One Last Kiss 风格生成器\"},{\"text\":\"AI智能定时任务插件\",\"link\":\"/AI智能定时任务插件\"},{\"text\":\"Token使用监控与管理\",\"link\":\"/Token使用监控与管理\"},{\"text\":\"QQ违规记录查询\",\"link\":\"/QQ违规记录查询\"},{\"text\":\"五子棋游戏\",\"link\":\"/五子棋游戏\"},{\"text\":\"评价QQ头像\",\"link\":\"/评价QQ头像\"},{\"text\":\"开盒群友\",\"link\":\"/开盒群友\"},{\"text\":\"AI画图\",\"link\":\"/AI画图\"},{\"text\":\"群成员查询插件\",\"link\":\"/群成员查询插件\"},{\"text\":\"关键词自动回复\",\"link\":\"/关键词自动回复\"},{\"text\":\"解析流媒体平台链接\",\"link\":\"/解析流媒体平台链接\"},{\"text\":\"Sora 模型生成视频\",\"link\":\"/Sora 模型生成视频\"},{\"text\":\"裁剪和合并gif\",\"link\":\"/裁剪和合并gif\"},{\"text\":\"猪猪表情包\",\"link\":\"/猪猪表情包\"},{\"text\":\"硬件信息查询\",\"link\":\"/硬件信息查询\"},{\"text\":\"无畏契约每日商店\",\"link\":\"/无畏契约每日商店\"},{\"text\":\"磁链解析插件\",\"link\":\"/磁链解析插件\"},{\"text\":\"用自然语言AI点歌\",\"link\":\"/用自然语言AI点歌\"},{\"text\":\"哈基米语音\",\"link\":\"/哈基米语音\"},{\"text\":\"AI自主管理群聊\",\"link\":\"/AI自主管理群聊\"},{\"text\":\"CS饰品查询\",\"link\":\"/CS饰品查询\"},{\"text\":\"基于AI的Galgame互动插件\",\"link\":\"/基于AI的Galgame互动插件\"},{\"text\":\"动漫磁链查询插件\",\"link\":\"/动漫磁链查询插件\"},{\"text\":\"狼人杀游戏\",\"link\":\"/狼人杀游戏\"}]}],\"socialLinks\":[{\"icon\":\"qq\",\"link\":\"https://qm.qq.com/q/nUxFhoI0VO\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>